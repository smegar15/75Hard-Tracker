{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":31,"index":31}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"./NavigationBuilderContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":32},"end":{"line":2,"column":66,"index":98}}],"key":"KFIEweWhugyJmWZL0YQ42pa68TE=","exportNames":["*"],"imports":1}},{"name":"./NavigationRouteContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":62,"index":161}}],"key":"I5Ob2ePenkMlCuG37rE0R3UVd48=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return useOnPreventRemove;\n    }\n  });\n  Object.defineProperty(exports, \"shouldPreventRemove\", {\n    enumerable: true,\n    get: function () {\n      return shouldPreventRemove;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var React = _interopNamespace(_react);\n  var _NavigationBuilderContext = require(_dependencyMap[1], \"./NavigationBuilderContext\");\n  var NavigationBuilderContext = _interopDefault(_NavigationBuilderContext);\n  var _NavigationRouteContext = require(_dependencyMap[2], \"./NavigationRouteContext\");\n  var NavigationRouteContext = _interopDefault(_NavigationRouteContext);\n  const VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n  const shouldPreventRemove = (emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) => {\n    const nextRouteKeys = nextRoutes.map(route => route.key);\n\n    // Call these in reverse order so last screens handle the event first\n    const removedRoutes = currentRoutes.filter(route => !nextRouteKeys.includes(route.key)).reverse();\n    const visitedRouteKeys =\n    // @ts-expect-error: add this property to mark that we've already emitted this action\n    action[VISITED_ROUTE_KEYS] ?? new Set();\n    const beforeRemoveAction = Object.assign({}, action, {\n      [VISITED_ROUTE_KEYS]: visitedRouteKeys\n    });\n    for (const route of removedRoutes) {\n      var _beforeRemoveListener;\n      if (visitedRouteKeys.has(route.key)) {\n        // Skip if we've already emitted this action for this screen\n        continue;\n      }\n\n      // First, we need to check if any child screens want to prevent it\n      const isPrevented = (_beforeRemoveListener = beforeRemoveListeners[route.key]) === null || _beforeRemoveListener === void 0 ? void 0 : _beforeRemoveListener.call(beforeRemoveListeners, beforeRemoveAction);\n      if (isPrevented) {\n        return true;\n      }\n      visitedRouteKeys.add(route.key);\n      const event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n    return false;\n  };\n  function useOnPreventRemove(_ref) {\n    let {\n      getState,\n      emitter,\n      beforeRemoveListeners\n    } = _ref;\n    const {\n      addKeyedListener\n    } = React.useContext(NavigationBuilderContext.default);\n    const route = React.useContext(NavigationRouteContext.default);\n    const routeKey = route === null || route === void 0 ? void 0 : route.key;\n    React.useEffect(() => {\n      if (routeKey) {\n        return addKeyedListener === null || addKeyedListener === void 0 ? void 0 : addKeyedListener('beforeRemove', routeKey, action => {\n          const state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":104,"map":[[27,2,44,15,"Object"],[27,8,44,15],[27,9,44,15,"defineProperty"],[27,23,44,15],[27,24,44,15,"exports"],[27,31,44,15],[28,4,44,15,"enumerable"],[28,14,44,15],[29,4,44,15,"get"],[29,7,44,15],[29,18,44,15,"get"],[29,19,44,15],[30,6,44,15],[30,13,44,15,"useOnPreventRemove"],[30,31,44,15],[31,4,44,15],[32,2,44,15],[33,2,5,0,"Object"],[33,8,5,0],[33,9,5,0,"defineProperty"],[33,23,5,0],[33,24,5,0,"exports"],[33,31,5,0],[34,4,5,0,"enumerable"],[34,14,5,0],[35,4,5,0,"get"],[35,7,5,0],[35,18,5,0,"get"],[35,19,5,0],[36,6,5,0],[36,13,5,0,"shouldPreventRemove"],[36,32,5,0],[37,4,5,0],[38,2,5,0],[39,2,1,0],[39,6,1,0,"_react"],[39,12,1,0],[39,15,1,0,"require"],[39,22,1,0],[39,23,1,0,"_dependencyMap"],[39,37,1,0],[40,2,1,0],[40,6,1,0,"React"],[40,11,1,0],[40,14,1,0,"_interopNamespace"],[40,31,1,0],[40,32,1,0,"_react"],[40,38,1,0],[41,2,2,0],[41,6,2,0,"_NavigationBuilderContext"],[41,31,2,0],[41,34,2,0,"require"],[41,41,2,0],[41,42,2,0,"_dependencyMap"],[41,56,2,0],[42,2,2,0],[42,6,2,0,"NavigationBuilderContext"],[42,30,2,0],[42,33,2,0,"_interopDefault"],[42,48,2,0],[42,49,2,0,"_NavigationBuilderContext"],[42,74,2,0],[43,2,3,0],[43,6,3,0,"_NavigationRouteContext"],[43,29,3,0],[43,32,3,0,"require"],[43,39,3,0],[43,40,3,0,"_dependencyMap"],[43,54,3,0],[44,2,3,0],[44,6,3,0,"NavigationRouteContext"],[44,28,3,0],[44,31,3,0,"_interopDefault"],[44,46,3,0],[44,47,3,0,"_NavigationRouteContext"],[44,70,3,0],[45,2,4,0],[45,8,4,6,"VISITED_ROUTE_KEYS"],[45,26,4,24],[45,29,4,27,"Symbol"],[45,35,4,33],[45,36,4,34],[45,56,4,54],[45,57,4,55],[46,2,5,7],[46,8,5,13,"shouldPreventRemove"],[46,27,5,32],[46,30,5,35,"shouldPreventRemove"],[46,31,5,36,"emitter"],[46,38,5,43],[46,40,5,45,"beforeRemoveListeners"],[46,61,5,66],[46,63,5,68,"currentRoutes"],[46,76,5,81],[46,78,5,83,"nextRoutes"],[46,88,5,93],[46,90,5,95,"action"],[46,96,5,101],[46,101,5,106],[47,4,6,2],[47,10,6,8,"nextRouteKeys"],[47,23,6,21],[47,26,6,24,"nextRoutes"],[47,36,6,34],[47,37,6,35,"map"],[47,40,6,38],[47,41,6,39,"route"],[47,46,6,44],[47,50,6,48,"route"],[47,55,6,53],[47,56,6,54,"key"],[47,59,6,57],[47,60,6,58],[49,4,8,2],[50,4,9,2],[50,10,9,8,"removedRoutes"],[50,23,9,21],[50,26,9,24,"currentRoutes"],[50,39,9,37],[50,40,9,38,"filter"],[50,46,9,44],[50,47,9,45,"route"],[50,52,9,50],[50,56,9,54],[50,57,9,55,"nextRouteKeys"],[50,70,9,68],[50,71,9,69,"includes"],[50,79,9,77],[50,80,9,78,"route"],[50,85,9,83],[50,86,9,84,"key"],[50,89,9,87],[50,90,9,88],[50,91,9,89],[50,92,9,90,"reverse"],[50,99,9,97],[50,100,9,98],[50,101,9,99],[51,4,10,2],[51,10,10,8,"visitedRouteKeys"],[51,26,10,24],[52,4,11,2],[53,4,12,2,"action"],[53,10,12,8],[53,11,12,9,"VISITED_ROUTE_KEYS"],[53,29,12,27],[53,30,12,28],[53,34,12,32],[53,38,12,36,"Set"],[53,41,12,39],[53,42,12,40],[53,43,12,41],[54,4,13,2],[54,10,13,8,"beforeRemoveAction"],[54,28,13,26],[54,31,13,26,"Object"],[54,37,13,26],[54,38,13,26,"assign"],[54,44,13,26],[54,49,14,7,"action"],[54,55,14,13],[55,6,15,4],[55,7,15,5,"VISITED_ROUTE_KEYS"],[55,25,15,23],[55,28,15,26,"visitedRouteKeys"],[56,4,15,42],[56,6,16,3],[57,4,17,2],[57,9,17,7],[57,15,17,13,"route"],[57,20,17,18],[57,24,17,22,"removedRoutes"],[57,37,17,35],[57,39,17,37],[58,6,18,4],[58,10,18,8,"_beforeRemoveListener"],[58,31,18,29],[59,6,19,4],[59,10,19,8,"visitedRouteKeys"],[59,26,19,24],[59,27,19,25,"has"],[59,30,19,28],[59,31,19,29,"route"],[59,36,19,34],[59,37,19,35,"key"],[59,40,19,38],[59,41,19,39],[59,43,19,41],[60,8,20,6],[61,8,21,6],[62,6,22,4],[64,6,24,4],[65,6,25,4],[65,12,25,10,"isPrevented"],[65,23,25,21],[65,26,25,24],[65,27,25,25,"_beforeRemoveListener"],[65,48,25,46],[65,51,25,49,"beforeRemoveListeners"],[65,72,25,70],[65,73,25,71,"route"],[65,78,25,76],[65,79,25,77,"key"],[65,82,25,80],[65,83,25,81],[65,89,25,87],[65,93,25,91],[65,97,25,95,"_beforeRemoveListener"],[65,118,25,116],[65,123,25,121],[65,128,25,126],[65,129,25,127],[65,132,25,130],[65,137,25,135],[65,138,25,136],[65,141,25,139,"_beforeRemoveListener"],[65,162,25,160],[65,163,25,161,"call"],[65,167,25,165],[65,168,25,166,"beforeRemoveListeners"],[65,189,25,187],[65,191,25,189,"beforeRemoveAction"],[65,209,25,207],[65,210,25,208],[66,6,26,4],[66,10,26,8,"isPrevented"],[66,21,26,19],[66,23,26,21],[67,8,27,6],[67,15,27,13],[67,19,27,17],[68,6,28,4],[69,6,29,4,"visitedRouteKeys"],[69,22,29,20],[69,23,29,21,"add"],[69,26,29,24],[69,27,29,25,"route"],[69,32,29,30],[69,33,29,31,"key"],[69,36,29,34],[69,37,29,35],[70,6,30,4],[70,12,30,10,"event"],[70,17,30,15],[70,20,30,18,"emitter"],[70,27,30,25],[70,28,30,26,"emit"],[70,32,30,30],[70,33,30,31],[71,8,31,6,"type"],[71,12,31,10],[71,14,31,12],[71,28,31,26],[72,8,32,6,"target"],[72,14,32,12],[72,16,32,14,"route"],[72,21,32,19],[72,22,32,20,"key"],[72,25,32,23],[73,8,33,6,"data"],[73,12,33,10],[73,14,33,12],[74,10,34,8,"action"],[74,16,34,14],[74,18,34,16,"beforeRemoveAction"],[75,8,35,6],[75,9,35,7],[76,8,36,6,"canPreventDefault"],[76,25,36,23],[76,27,36,25],[77,6,37,4],[77,7,37,5],[77,8,37,6],[78,6,38,4],[78,10,38,8,"event"],[78,15,38,13],[78,16,38,14,"defaultPrevented"],[78,32,38,30],[78,34,38,32],[79,8,39,6],[79,15,39,13],[79,19,39,17],[80,6,40,4],[81,4,41,2],[82,4,42,2],[82,11,42,9],[82,16,42,14],[83,2,43,0],[83,3,43,1],[84,2,44,15],[84,11,44,24,"useOnPreventRemove"],[84,29,44,42,"useOnPreventRemove"],[84,30,44,43,"_ref"],[84,34,44,47],[84,36,44,49],[85,4,45,2],[85,8,45,6],[86,6,46,4,"getState"],[86,14,46,12],[87,6,47,4,"emitter"],[87,13,47,11],[88,6,48,4,"beforeRemoveListeners"],[89,4,49,2],[89,5,49,3],[89,8,49,6,"_ref"],[89,12,49,10],[90,4,50,2],[90,10,50,8],[91,6,51,4,"addKeyedListener"],[92,4,52,2],[92,5,52,3],[92,8,52,6,"React"],[92,13,52,11],[92,14,52,12,"useContext"],[92,24,52,22],[92,25,52,23,"NavigationBuilderContext"],[92,49,52,47],[92,50,52,47,"default"],[92,57,52,47],[92,58,52,48],[93,4,53,2],[93,10,53,8,"route"],[93,15,53,13],[93,18,53,16,"React"],[93,23,53,21],[93,24,53,22,"useContext"],[93,34,53,32],[93,35,53,33,"NavigationRouteContext"],[93,57,53,55],[93,58,53,55,"default"],[93,65,53,55],[93,66,53,56],[94,4,54,2],[94,10,54,8,"routeKey"],[94,18,54,16],[94,21,54,19,"route"],[94,26,54,24],[94,31,54,29],[94,35,54,33],[94,39,54,37,"route"],[94,44,54,42],[94,49,54,47],[94,54,54,52],[94,55,54,53],[94,58,54,56],[94,63,54,61],[94,64,54,62],[94,67,54,65,"route"],[94,72,54,70],[94,73,54,71,"key"],[94,76,54,74],[95,4,55,2,"React"],[95,9,55,7],[95,10,55,8,"useEffect"],[95,19,55,17],[95,20,55,18],[95,26,55,24],[96,6,56,4],[96,10,56,8,"routeKey"],[96,18,56,16],[96,20,56,18],[97,8,57,6],[97,15,57,13,"addKeyedListener"],[97,31,57,29],[97,36,57,34],[97,40,57,38],[97,44,57,42,"addKeyedListener"],[97,60,57,58],[97,65,57,63],[97,70,57,68],[97,71,57,69],[97,74,57,72],[97,79,57,77],[97,80,57,78],[97,83,57,81,"addKeyedListener"],[97,99,57,97],[97,100,57,98],[97,114,57,112],[97,116,57,114,"routeKey"],[97,124,57,122],[97,126,57,124,"action"],[97,132,57,130],[97,136,57,134],[98,10,58,8],[98,16,58,14,"state"],[98,21,58,19],[98,24,58,22,"getState"],[98,32,58,30],[98,33,58,31],[98,34,58,32],[99,10,59,8],[99,17,59,15,"shouldPreventRemove"],[99,36,59,34],[99,37,59,35,"emitter"],[99,44,59,42],[99,46,59,44,"beforeRemoveListeners"],[99,67,59,65],[99,69,59,67,"state"],[99,74,59,72],[99,75,59,73,"routes"],[99,81,59,79],[99,83,59,81],[99,85,59,83],[99,87,59,85,"action"],[99,93,59,91],[99,94,59,92],[100,8,60,6],[100,9,60,7],[100,10,60,8],[101,6,61,4],[102,4,62,2],[102,5,62,3],[102,7,62,5],[102,8,62,6,"addKeyedListener"],[102,24,62,22],[102,26,62,24,"beforeRemoveListeners"],[102,47,62,45],[102,49,62,47,"emitter"],[102,56,62,54],[102,58,62,56,"getState"],[102,66,62,64],[102,68,62,66,"routeKey"],[102,76,62,74],[102,77,62,75],[102,78,62,76],[103,2,63,0],[104,0,63,1],[104,3]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","addKeyedListener$argument_2"],"mappings":"AAA;mCCI;uCCC,kBD;6CEG,2CF;CDkC;eIC;kBCW;4HCE;ODG;GDE;CJC"},"hasCjsExports":false},"type":"js/module"}]}