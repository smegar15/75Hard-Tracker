{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":31,"index":31}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"./NavigationBuilderContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":32},"end":{"line":2,"column":66,"index":98}}],"key":"KFIEweWhugyJmWZL0YQ42pa68TE=","exportNames":["*"],"imports":1}},{"name":"./useOnPreventRemove","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":79,"index":178}}],"key":"zHx1fnpyahkAQTykmUTy5XV/k3A=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return useOnAction;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var React = _interopNamespace(_react);\n  var _NavigationBuilderContext = require(_dependencyMap[1], \"./NavigationBuilderContext\");\n  var NavigationBuilderContext = _interopDefault(_NavigationBuilderContext);\n  var _useOnPreventRemove = require(_dependencyMap[2], \"./useOnPreventRemove\");\n  var useOnPreventRemove = _interopDefault(_useOnPreventRemove);\n  /**\n   * Hook to handle actions for a navigator, including state updates and bubbling.\n   *\n   * Bubbling an action is achieved in 2 ways:\n   * 1. To bubble action to parent, we expose the action handler in context and then access the parent context\n   * 2. To bubble action to child, child adds event listeners subscribing to actions from parent\n   *\n   * When the action handler handles as action, it returns `true`, otherwise `false`.\n   */\n  function useOnAction(_ref) {\n    let {\n      router,\n      getState,\n      setState,\n      key,\n      actionListeners,\n      beforeRemoveListeners,\n      routerConfigOptions,\n      emitter\n    } = _ref;\n    const {\n      onAction: onActionParent,\n      onRouteFocus: onRouteFocusParent,\n      addListener: addListenerParent,\n      onDispatchAction\n    } = React.useContext(NavigationBuilderContext.default);\n    const routerConfigOptionsRef = React.useRef(routerConfigOptions);\n    React.useEffect(() => {\n      routerConfigOptionsRef.current = routerConfigOptions;\n    });\n    const onAction = React.useCallback(function (action) {\n      let visitedNavigators = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Set();\n      const state = getState();\n\n      // Since actions can bubble both up and down, they could come to the same navigator again\n      // We keep track of navigators which have already tried to handle the action and return if it's already visited\n      if (visitedNavigators.has(state.key)) {\n        return false;\n      }\n      visitedNavigators.add(state.key);\n      if (typeof action.target !== 'string' || action.target === state.key) {\n        let result = router.getStateForAction(state, action, routerConfigOptionsRef.current);\n\n        // If a target is specified and set to current navigator, the action shouldn't bubble\n        // So instead of `null`, we use the state object for such cases to signal that action was handled\n        result = result === null && action.target === state.key ? state : result;\n        if (result !== null) {\n          onDispatchAction(action, state === result);\n          if (state !== result) {\n            const isPrevented = (0, _useOnPreventRemove.shouldPreventRemove)(emitter, beforeRemoveListeners, state.routes, result.routes, action);\n            if (isPrevented) {\n              return true;\n            }\n            setState(result);\n          }\n          if (onRouteFocusParent !== undefined) {\n            // Some actions such as `NAVIGATE` also want to bring the navigated route to focus in the whole tree\n            // This means we need to focus all of the parent navigators of this navigator as well\n            const shouldFocus = router.shouldActionChangeFocus(action);\n            if (shouldFocus && key !== undefined) {\n              onRouteFocusParent(key);\n            }\n          }\n          return true;\n        }\n      }\n      if (onActionParent !== undefined) {\n        // Bubble action to the parent if the current navigator didn't handle it\n        if (onActionParent(action, visitedNavigators)) {\n          return true;\n        }\n      }\n\n      // If the action wasn't handled by current navigator or a parent navigator, let children handle it\n      for (let i = actionListeners.length - 1; i >= 0; i--) {\n        const listener = actionListeners[i];\n        if (listener(action, visitedNavigators)) {\n          return true;\n        }\n      }\n      return false;\n    }, [actionListeners, beforeRemoveListeners, emitter, getState, key, onActionParent, onDispatchAction, onRouteFocusParent, router, setState]);\n    (0, useOnPreventRemove.default)({\n      getState,\n      emitter,\n      beforeRemoveListeners\n    });\n    React.useEffect(() => addListenerParent === null || addListenerParent === void 0 ? void 0 : addListenerParent('action', onAction), [addListenerParent, onAction]);\n    return onAction;\n  }\n});","lineCount":129,"map":[[27,2,13,15,"Object"],[27,8,13,15],[27,9,13,15,"defineProperty"],[27,23,13,15],[27,24,13,15,"exports"],[27,31,13,15],[28,4,13,15,"enumerable"],[28,14,13,15],[29,4,13,15,"get"],[29,7,13,15],[29,18,13,15,"get"],[29,19,13,15],[30,6,13,15],[30,13,13,15,"useOnAction"],[30,24,13,15],[31,4,13,15],[32,2,13,15],[33,2,1,0],[33,6,1,0,"_react"],[33,12,1,0],[33,15,1,0,"require"],[33,22,1,0],[33,23,1,0,"_dependencyMap"],[33,37,1,0],[34,2,1,0],[34,6,1,0,"React"],[34,11,1,0],[34,14,1,0,"_interopNamespace"],[34,31,1,0],[34,32,1,0,"_react"],[34,38,1,0],[35,2,2,0],[35,6,2,0,"_NavigationBuilderContext"],[35,31,2,0],[35,34,2,0,"require"],[35,41,2,0],[35,42,2,0,"_dependencyMap"],[35,56,2,0],[36,2,2,0],[36,6,2,0,"NavigationBuilderContext"],[36,30,2,0],[36,33,2,0,"_interopDefault"],[36,48,2,0],[36,49,2,0,"_NavigationBuilderContext"],[36,74,2,0],[37,2,3,0],[37,6,3,0,"_useOnPreventRemove"],[37,25,3,0],[37,28,3,0,"require"],[37,35,3,0],[37,36,3,0,"_dependencyMap"],[37,50,3,0],[38,2,3,0],[38,6,3,0,"useOnPreventRemove"],[38,24,3,0],[38,27,3,0,"_interopDefault"],[38,42,3,0],[38,43,3,0,"_useOnPreventRemove"],[38,62,3,0],[39,2,4,0],[40,0,5,0],[41,0,6,0],[42,0,7,0],[43,0,8,0],[44,0,9,0],[45,0,10,0],[46,0,11,0],[47,0,12,0],[48,2,13,15],[48,11,13,24,"useOnAction"],[48,22,13,35,"useOnAction"],[48,23,13,36,"_ref"],[48,27,13,40],[48,29,13,42],[49,4,14,2],[49,8,14,6],[50,6,15,4,"router"],[50,12,15,10],[51,6,16,4,"getState"],[51,14,16,12],[52,6,17,4,"setState"],[52,14,17,12],[53,6,18,4,"key"],[53,9,18,7],[54,6,19,4,"actionListeners"],[54,21,19,19],[55,6,20,4,"beforeRemoveListeners"],[55,27,20,25],[56,6,21,4,"routerConfigOptions"],[56,25,21,23],[57,6,22,4,"emitter"],[58,4,23,2],[58,5,23,3],[58,8,23,6,"_ref"],[58,12,23,10],[59,4,24,2],[59,10,24,8],[60,6,25,4,"onAction"],[60,14,25,12],[60,16,25,14,"onActionParent"],[60,30,25,28],[61,6,26,4,"onRouteFocus"],[61,18,26,16],[61,20,26,18,"onRouteFocusParent"],[61,38,26,36],[62,6,27,4,"addListener"],[62,17,27,15],[62,19,27,17,"addListenerParent"],[62,36,27,34],[63,6,28,4,"onDispatchAction"],[64,4,29,2],[64,5,29,3],[64,8,29,6,"React"],[64,13,29,11],[64,14,29,12,"useContext"],[64,24,29,22],[64,25,29,23,"NavigationBuilderContext"],[64,49,29,47],[64,50,29,47,"default"],[64,57,29,47],[64,58,29,48],[65,4,30,2],[65,10,30,8,"routerConfigOptionsRef"],[65,32,30,30],[65,35,30,33,"React"],[65,40,30,38],[65,41,30,39,"useRef"],[65,47,30,45],[65,48,30,46,"routerConfigOptions"],[65,67,30,65],[65,68,30,66],[66,4,31,2,"React"],[66,9,31,7],[66,10,31,8,"useEffect"],[66,19,31,17],[66,20,31,18],[66,26,31,24],[67,6,32,4,"routerConfigOptionsRef"],[67,28,32,26],[67,29,32,27,"current"],[67,36,32,34],[67,39,32,37,"routerConfigOptions"],[67,58,32,56],[68,4,33,2],[68,5,33,3],[68,6,33,4],[69,4,34,2],[69,10,34,8,"onAction"],[69,18,34,16],[69,21,34,19,"React"],[69,26,34,24],[69,27,34,25,"useCallback"],[69,38,34,36],[69,39,34,37],[69,49,34,47,"action"],[69,55,34,53],[69,57,34,55],[70,6,35,4],[70,10,35,8,"visitedNavigators"],[70,27,35,25],[70,30,35,28,"arguments"],[70,39,35,37],[70,40,35,38,"length"],[70,46,35,44],[70,49,35,47],[70,50,35,48],[70,54,35,52,"arguments"],[70,63,35,61],[70,64,35,62],[70,65,35,63],[70,66,35,64],[70,71,35,69,"undefined"],[70,80,35,78],[70,83,35,81,"arguments"],[70,92,35,90],[70,93,35,91],[70,94,35,92],[70,95,35,93],[70,98,35,96],[70,102,35,100,"Set"],[70,105,35,103],[70,106,35,104],[70,107,35,105],[71,6,36,4],[71,12,36,10,"state"],[71,17,36,15],[71,20,36,18,"getState"],[71,28,36,26],[71,29,36,27],[71,30,36,28],[73,6,38,4],[74,6,39,4],[75,6,40,4],[75,10,40,8,"visitedNavigators"],[75,27,40,25],[75,28,40,26,"has"],[75,31,40,29],[75,32,40,30,"state"],[75,37,40,35],[75,38,40,36,"key"],[75,41,40,39],[75,42,40,40],[75,44,40,42],[76,8,41,6],[76,15,41,13],[76,20,41,18],[77,6,42,4],[78,6,43,4,"visitedNavigators"],[78,23,43,21],[78,24,43,22,"add"],[78,27,43,25],[78,28,43,26,"state"],[78,33,43,31],[78,34,43,32,"key"],[78,37,43,35],[78,38,43,36],[79,6,44,4],[79,10,44,8],[79,17,44,15,"action"],[79,23,44,21],[79,24,44,22,"target"],[79,30,44,28],[79,35,44,33],[79,43,44,41],[79,47,44,45,"action"],[79,53,44,51],[79,54,44,52,"target"],[79,60,44,58],[79,65,44,63,"state"],[79,70,44,68],[79,71,44,69,"key"],[79,74,44,72],[79,76,44,74],[80,8,45,6],[80,12,45,10,"result"],[80,18,45,16],[80,21,45,19,"router"],[80,27,45,25],[80,28,45,26,"getStateForAction"],[80,45,45,43],[80,46,45,44,"state"],[80,51,45,49],[80,53,45,51,"action"],[80,59,45,57],[80,61,45,59,"routerConfigOptionsRef"],[80,83,45,81],[80,84,45,82,"current"],[80,91,45,89],[80,92,45,90],[82,8,47,6],[83,8,48,6],[84,8,49,6,"result"],[84,14,49,12],[84,17,49,15,"result"],[84,23,49,21],[84,28,49,26],[84,32,49,30],[84,36,49,34,"action"],[84,42,49,40],[84,43,49,41,"target"],[84,49,49,47],[84,54,49,52,"state"],[84,59,49,57],[84,60,49,58,"key"],[84,63,49,61],[84,66,49,64,"state"],[84,71,49,69],[84,74,49,72,"result"],[84,80,49,78],[85,8,50,6],[85,12,50,10,"result"],[85,18,50,16],[85,23,50,21],[85,27,50,25],[85,29,50,27],[86,10,51,8,"onDispatchAction"],[86,26,51,24],[86,27,51,25,"action"],[86,33,51,31],[86,35,51,33,"state"],[86,40,51,38],[86,45,51,43,"result"],[86,51,51,49],[86,52,51,50],[87,10,52,8],[87,14,52,12,"state"],[87,19,52,17],[87,24,52,22,"result"],[87,30,52,28],[87,32,52,30],[88,12,53,10],[88,18,53,16,"isPrevented"],[88,29,53,27],[88,32,53,30],[88,36,53,30,"shouldPreventRemove"],[88,55,53,49],[88,56,53,49,"shouldPreventRemove"],[88,75,53,49],[88,77,53,50,"emitter"],[88,84,53,57],[88,86,53,59,"beforeRemoveListeners"],[88,107,53,80],[88,109,53,82,"state"],[88,114,53,87],[88,115,53,88,"routes"],[88,121,53,94],[88,123,53,96,"result"],[88,129,53,102],[88,130,53,103,"routes"],[88,136,53,109],[88,138,53,111,"action"],[88,144,53,117],[88,145,53,118],[89,12,54,10],[89,16,54,14,"isPrevented"],[89,27,54,25],[89,29,54,27],[90,14,55,12],[90,21,55,19],[90,25,55,23],[91,12,56,10],[92,12,57,10,"setState"],[92,20,57,18],[92,21,57,19,"result"],[92,27,57,25],[92,28,57,26],[93,10,58,8],[94,10,59,8],[94,14,59,12,"onRouteFocusParent"],[94,32,59,30],[94,37,59,35,"undefined"],[94,46,59,44],[94,48,59,46],[95,12,60,10],[96,12,61,10],[97,12,62,10],[97,18,62,16,"shouldFocus"],[97,29,62,27],[97,32,62,30,"router"],[97,38,62,36],[97,39,62,37,"shouldActionChangeFocus"],[97,62,62,60],[97,63,62,61,"action"],[97,69,62,67],[97,70,62,68],[98,12,63,10],[98,16,63,14,"shouldFocus"],[98,27,63,25],[98,31,63,29,"key"],[98,34,63,32],[98,39,63,37,"undefined"],[98,48,63,46],[98,50,63,48],[99,14,64,12,"onRouteFocusParent"],[99,32,64,30],[99,33,64,31,"key"],[99,36,64,34],[99,37,64,35],[100,12,65,10],[101,10,66,8],[102,10,67,8],[102,17,67,15],[102,21,67,19],[103,8,68,6],[104,6,69,4],[105,6,70,4],[105,10,70,8,"onActionParent"],[105,24,70,22],[105,29,70,27,"undefined"],[105,38,70,36],[105,40,70,38],[106,8,71,6],[107,8,72,6],[107,12,72,10,"onActionParent"],[107,26,72,24],[107,27,72,25,"action"],[107,33,72,31],[107,35,72,33,"visitedNavigators"],[107,52,72,50],[107,53,72,51],[107,55,72,53],[108,10,73,8],[108,17,73,15],[108,21,73,19],[109,8,74,6],[110,6,75,4],[112,6,77,4],[113,6,78,4],[113,11,78,9],[113,15,78,13,"i"],[113,16,78,14],[113,19,78,17,"actionListeners"],[113,34,78,32],[113,35,78,33,"length"],[113,41,78,39],[113,44,78,42],[113,45,78,43],[113,47,78,45,"i"],[113,48,78,46],[113,52,78,50],[113,53,78,51],[113,55,78,53,"i"],[113,56,78,54],[113,58,78,56],[113,60,78,58],[114,8,79,6],[114,14,79,12,"listener"],[114,22,79,20],[114,25,79,23,"actionListeners"],[114,40,79,38],[114,41,79,39,"i"],[114,42,79,40],[114,43,79,41],[115,8,80,6],[115,12,80,10,"listener"],[115,20,80,18],[115,21,80,19,"action"],[115,27,80,25],[115,29,80,27,"visitedNavigators"],[115,46,80,44],[115,47,80,45],[115,49,80,47],[116,10,81,8],[116,17,81,15],[116,21,81,19],[117,8,82,6],[118,6,83,4],[119,6,84,4],[119,13,84,11],[119,18,84,16],[120,4,85,2],[120,5,85,3],[120,7,85,5],[120,8,85,6,"actionListeners"],[120,23,85,21],[120,25,85,23,"beforeRemoveListeners"],[120,46,85,44],[120,48,85,46,"emitter"],[120,55,85,53],[120,57,85,55,"getState"],[120,65,85,63],[120,67,85,65,"key"],[120,70,85,68],[120,72,85,70,"onActionParent"],[120,86,85,84],[120,88,85,86,"onDispatchAction"],[120,104,85,102],[120,106,85,104,"onRouteFocusParent"],[120,124,85,122],[120,126,85,124,"router"],[120,132,85,130],[120,134,85,132,"setState"],[120,142,85,140],[120,143,85,141],[120,144,85,142],[121,4,86,2],[121,8,86,2,"useOnPreventRemove"],[121,26,86,20],[121,27,86,20,"default"],[121,34,86,20],[121,36,86,21],[122,6,87,4,"getState"],[122,14,87,12],[123,6,88,4,"emitter"],[123,13,88,11],[124,6,89,4,"beforeRemoveListeners"],[125,4,90,2],[125,5,90,3],[125,6,90,4],[126,4,91,2,"React"],[126,9,91,7],[126,10,91,8,"useEffect"],[126,19,91,17],[126,20,91,18],[126,26,91,24,"addListenerParent"],[126,43,91,41],[126,48,91,46],[126,52,91,50],[126,56,91,54,"addListenerParent"],[126,73,91,71],[126,78,91,76],[126,83,91,81],[126,84,91,82],[126,87,91,85],[126,92,91,90],[126,93,91,91],[126,96,91,94,"addListenerParent"],[126,113,91,111],[126,114,91,112],[126,122,91,120],[126,124,91,122,"onAction"],[126,132,91,130],[126,133,91,131],[126,135,91,133],[126,136,91,134,"addListenerParent"],[126,153,91,151],[126,155,91,153,"onAction"],[126,163,91,161],[126,164,91,162],[126,165,91,163],[127,4,92,2],[127,11,92,9,"onAction"],[127,19,92,17],[128,2,93,0],[129,0,93,1],[129,3]],"functionMap":{"names":["<global>","useOnAction","React.useEffect$argument_0","onAction"],"mappings":"AAA;eCY;kBCkB;GDE;qCEC;GFmD;kBCM,iHD;CDE"},"hasCjsExports":false},"type":"js/module"}]}